server {
    listen 8000;
    root /home/ubuntu/dgraph/wiki/public;
    add_header Cache-Control "no-cache";
    rewrite ^/v0.7.4/deploy$ https://dgraph.io/docs/deploy permanent;
    rewrite ^/v0.7.4/design-concepts$ https://dgraph.io/docs/design-concepts permanent;
    rewrite ^/v0.7.4/faq$ https://dgraph.io/docs/faq permanent;
    rewrite ^/v0.7.6/get-started$ https://dgraph.io/docs/get-started permanent;
    rewrite ^/v0.7.7/get-started$ https://dgraph.io/docs/get-started permanent;
    rewrite ^/v0.7.4/query-language$ https://dgraph.io/docs/query-language permanent;
    rewrite ^/v0.7.6/query-language$ https://dgraph.io/docs/query-language permanent;
    rewrite ^/v0.7.7/query-language$ https://dgraph.io/docs/query-language permanent;
    rewrite ^/v0.8.3/query-language$ https://dgraph.io/docs/query-language permanent;

    # rewrite ^(/v20.03.4)/query-language/(.*)$ $1/query-language redirect;
    # rewrite ^(/v20.03.3)/query-language/(.*)$ $1/query-language redirect;
    # rewrite ^(/v20.03.2)/query-language/(.*)$ $1/query-language redirect;
    # rewrite ^(/v20.03.1)/query-language/(.*)$ $1/query-language redirect;
    # rewrite ^(/v20.03.0)/query-language/(.*)$ $1/query-language redirect;
    # rewrite ^(/v20.03.0)/query-language/(.*)$ $1/query-language redirect;
    # rewrite ^(/v1.*)/query-language/(.*)$ $1/query-language redirect;

    # rewrite ^(/v20.03.4)/mutations/(.*)$ $1/mutations redirect;
    # rewrite ^(/v20.03.3)/mutations/(.*)$ $1/mutations redirect;
    # rewrite ^(/v20.03.2)/mutations/(.*)$ $1/mutations redirect;
    # rewrite ^(/v20.03.1)/mutations/(.*)$ $1/mutations redirect;
    # rewrite ^(/v20.03.0)/mutations/(.*)$ $1/mutations redirect;
    # rewrite ^(/v20.03.0)/mutations/(.*)$ $1/mutations redirect;
    # rewrite ^(/v1.*)/mutations/(.*)$ $1/mutations redirect;

    rewrite ^(/v20.03.4)/clients/(.*)$ $1/clients redirect;
    rewrite ^(/v20.03.3/\w+)/(.*)$ $1 redirect;
    # rewrite ^(/v20.03.2)/clients/(.*)$ $1/clients redirect;
    # rewrite ^(/v20.03.1)/clients/(.*)$ $1/clients redirect;
    # rewrite ^(/v20.03.0)/clients/(.*)$ $1/clients redirect;
    # rewrite ^(/v20.03.0)/clients/(.*)$ $1/clients redirect;
    # rewrite ^(/v1.*)/clients/(.*)$ $1/clients redirect;

    # rewrite ^(/v20.03.4)/deploy/(.*)$ $1/deploy redirect;
    # rewrite ^(/v20.03.3)/deploy/(.*)$ $1/deploy redirect;
    # rewrite ^(/v20.03.2)/deploy/(.*)$ $1/deploy redirect;
    # rewrite ^(/v20.03.1)/deploy/(.*)$ $1/deploy redirect;
    # rewrite ^(/v20.03.0)/deploy/(.*)$ $1/deploy redirect;
    # rewrite ^(/v20.03.0)/deploy/(.*)$ $1/deploy redirect;
    # rewrite ^(/v1.*)/deploy/(.*)$ $1/deploy redirect;

    # rewrite ^(/v20.03.4)/enterprise-features/(.*)$ $1/enterprise-features redirect;
    # rewrite ^(/v20.03.3)/enterprise-features/(.*)$ $1/enterprise-features redirect;
    # rewrite ^(/v20.03.2)/enterprise-features/(.*)$ $1/enterprise-features redirect;
    # rewrite ^(/v20.03.1)/enterprise-features/(.*)$ $1/enterprise-features redirect;
    # rewrite ^(/v20.03.0)/enterprise-features/(.*)$ $1/enterprise-features redirect;
    # rewrite ^(/v20.03.0)/enterprise-features/(.*)$ $1/enterprise-features redirect;
    # rewrite ^(/v1.*)/enterprise-features/(.*)$ $1/enterprise-features redirect;

    # rewrite ^(/v20.03.4)/howto/(.*)$ $1/howto redirect;
    # rewrite ^(/v20.03.3)/howto/(.*)$ $1/howto redirect;
    # rewrite ^(/v20.03.2)/howto/(.*)$ $1/howto redirect;
    # rewrite ^(/v20.03.1)/howto/(.*)$ $1/howto redirect;
    # rewrite ^(/v20.03.0)/howto/(.*)$ $1/howto redirect;
    # rewrite ^(/v20.03.0)/howto/(.*)$ $1/howto redirect;
    # rewrite ^(/v1.*)/howto/(.*)$ $1/howto redirect;

    # rewrite ^(/v20.03.4)/design-concepts/(.*)$ $1/design-concepts redirect;
    # rewrite ^(/v20.03.3)/design-concepts/(.*)$ $1/design-concepts redirect;
    # rewrite ^(/v20.03.2)/design-concepts/(.*)$ $1/design-concepts redirect;
    # rewrite ^(/v20.03.1)/design-concepts/(.*)$ $1/design-concepts redirect;
    # rewrite ^(/v20.03.0)/design-concepts/(.*)$ $1/design-concepts redirect;
    # rewrite ^(/v20.03.0)/design-concepts/(.*)$ $1/design-concepts redirect;
    # rewrite ^(/v1.*)/design-concepts/(.*)$ $1/design-concepts redirect;

    location / {
      try_files $uri $uri/index.html /404.html;
    }
}
